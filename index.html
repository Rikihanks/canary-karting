<!DOCTYPE html>
<html lang="es">
<head>
ย ย <meta charset="UTF-8" />
ย ย <meta name="viewport" content="width=device-width, initial-scale=1" />
ย ย <title>Clasificaciรณn General CK</title>
ย ย <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;600;800&family=Russo+One&display=swap" rel="stylesheet">
ย ย <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">

    <link rel="manifest" href="./manifest.json">

ย ย <style>
ย ย ย ย .navbar {
ย ย ย ย ย ย display: flex;
ย ย ย ย ย ย justify-content: center;
ย ย ย ย ย ย gap: 2rem;
ย ย ย ย ย ย padding: 1rem 0;
ย ย ย ย ย ย margin-bottom: 2rem;
ย ย ย ย ย ย border-bottom: 1px solid rgba(59, 130, 246, 0.2);
ย ย ย ย ย ย width: 100%;
ย ย ย ย }

ย ย ย ย .nav-link {
ย ย ย ย ย ย font-family: 'Montserrat', sans-serif;
ย ย ย ย ย ย text-decoration: none;
ย ย ย ย ย ย font-weight: 700;
ย ย ย ย ย ย color: #94a3b8;
ย ย ย ย ย ย transition: color 0.3s, text-shadow 0.3s;
ย ย ย ย }

ย ย ย ย .nav-link:hover {
ย ย ย ย ย ย color: var(--accent);
ย ย ย ย ย ย text-shadow: 0 0 5px rgba(59, 130, 246, 0.8);
ย ย ย ย }

ย ย ย ย :root {
ย ย ย ย ย ย --bg-color: #0f172a;
ย ย ย ย ย ย --card-bg: rgba(30, 41, 59, 0.6);
ย ย ย ย ย ย --text-main: #f1f5f9;
ย ย ย ย ย ย --accent: #3b82f6;
ย ย ย ย ย ย --gold: #fbbf24;
ย ย ย ย ย ย --silver: #94a3b8;
ย ย ย ย ย ย --bronze: #d97706;
ย ย ย ย }

ย ย ย ย * { box-sizing: border-box; }

ย ย ย ย body {
ย ย ย ย ย ย font-family: 'Montserrat', sans-serif;
ย ย ย ย ย ย margin: 0;
ย ย ย ย ย ย padding: 1rem;
ย ย ย ย ย ย background-color: var(--bg-color);
ย ย ย ย ย ย background-image:ย
ย ย ย ย ย ย ย ย radial-gradient(circle at 10% 20%, rgba(59, 130, 246, 0.15) 0%, transparent 20%),
ย ย ย ย ย ย ย ย radial-gradient(circle at 90% 80%, rgba(239, 68, 68, 0.15) 0%, transparent 20%);
ย ย ย ย ย ย color: var(--text-main);
ย ย ย ย ย ย min-height: 100vh;
ย ย ย ย }

ย ย ย ย /* Tรญtulo Brillante */
ย ย ย ย h1 {
ย ย ย ย ย ย font-family: 'Russo One', sans-serif;
ย ย ย ย ย ย text-align: center;
ย ย ย ย ย ย font-size: 2.5rem;
ย ย ย ย ย ย text-transform: uppercase;
ย ย ย ย ย ย letter-spacing: 2px;
ย ย ย ย ย ย margin-bottom: 2rem;
ย ย ย ย ย ยย
ย ย ย ย ย ย background: linear-gradient(180deg, #ffffff 20%, #bae6fd 100%);
ย ย ย ย ย ย -webkit-background-clip: text;
ย ย ย ย ย ย background-clip: text;
ย ย ย ย ย ย color: transparent;
ย ย ย ย ย ย filter: drop-shadow(0 0 5px rgba(59, 130, 246, 0.6))ย
ย ย ย ย ย ย ย ย ย ย drop-shadow(0 4px 4px rgba(0, 0, 0, 0.5));
ย ย ย ย }

ย ย ย ย .container {
ย ย ย ย ย ย max-width: 800px;
ย ย ย ย ย ย margin: 0 auto;
ย ย ย ย }

ย ย ย ย /* --- ESTILOS DE ENLACE --- */
ย ย ย ย .podium-card-link, .list-item-link {
ย ย ย ย ย ย text-decoration: none;
ย ย ย ย ย ย color: inherit;
ย ย ย ย ย ย display: block;
ย ย ย ย ย ย transition: transform 0.2s;
ย ย ย ย }
ย ย ย ย .podium-card-link:hover .podium-card, .list-item-link:hover .list-item {
ย ย ย ย ย ย transform: translateY(-5px) scale(1.01);
ย ย ย ย ย ย box-shadow: 0 10px 20px rgba(59, 130, 246, 0.5);
ย ย ย ย }

ย ย ย ย /* --- PODIO (Top 3) --- */
.podium {
ย ย display: flex;
ย ย justify-content: center;
ย ย align-items: flex-end; /* Alinea las tarjetas desde abajo (efecto pedestal) */
ย ย gap: 1rem;
ย ย margin-bottom: 3rem;
ย ย padding-top: 1rem;
}

.podium-card {
ย ย background: var(--card-bg);
ย ย backdrop-filter: blur(10px);
ย ย border-radius: 16px;
ย ย padding: 1.5rem;
ย ย text-align: center;
ย ย position: relative;
ย ย width: 30%;
ย ย min-height: 200px; /* Altura base mรญnima */
ย ย display: flex; /* Asegura el centrado vertical en la card */
ย ย flex-direction: column;
ย ย justify-content: center; /* Centro el contenido verticalmente */
ย ย border: 1px solid rgba(255,255,255,0.1);
ย ย transition: all 0.2s;
}

/* --- ANIMACIรN DE PULSO DE NEรN (Sin cambios) --- */
ย ย ย ย @keyframes glowPulseGold {
ย ย ย ย ย ย 0% { box-shadow: 0 0 15px rgba(251, 191, 36, 0.3), inset 0 0 10px rgba(251, 191, 36, 0.1); border-color: rgba(251, 191, 36, 0.5); }
ย ย ย ย ย ย 100% { box-shadow: 0 0 35px rgba(251, 191, 36, 0.6), inset 0 0 20px rgba(251, 191, 36, 0.2); border-color: rgba(251, 191, 36, 1); }
ย ย ย ย }
ย ย ย ย @keyframes glowPulseSilver {
ย ย ย ย ย ย 0% { box-shadow: 0 0 15px rgba(148, 163, 184, 0.3); border-color: rgba(148, 163, 184, 0.5); }
ย ย ย ย ย ย 100% { box-shadow: 0 0 30px rgba(148, 163, 184, 0.5); border-color: rgba(148, 163, 184, 1); }
ย ย ย ย }
ย ย ย ย @keyframes glowPulseBronze {
ย ย ย ย ย ย 0% { box-shadow: 0 0 15px rgba(217, 119, 6, 0.3); border-color: rgba(217, 119, 6, 0.5); }
ย ย ย ย ย ย 100% { box-shadow: 0 0 30px rgba(217, 119, 6, 0.6); border-color: rgba(217, 119, 6, 1); }
ย ย ย ย }

/* ๐ฅ ORO */
.rank-1 {ย
ย ย order: 2; /* 1er puesto en el centro */
ย ย transform: scale(1.05); /* Ligeramente mรกs grande */
ย ย min-height: 280px; /* Mรกs alto que el resto */
ย ย z-index: 2;ย
ย ย animation: glowPulseGold 2s infinite alternate ease-in-out;
}

/* ๐ฅ PLATA */
.rank-2 {ย
ย ย order: 1; /* 2do puesto a la izquierda */
ย ย min-height: 240px; /* Altura intermedia */
ย ย margin-bottom: 0; /* Eliminar el margen negativo anterior */
ย ย animation: glowPulseSilver 3s infinite alternate ease-in-out;
}

/* ๐ฅ BRONCE */
.rank-3 {ย
ย ย order: 3; /* 3er puesto a la derecha */
ย ย min-height: 220px; /* El mรกs bajo */
ย ย margin-bottom: 0; /* Eliminar el margen negativo anterior */
ย ย animation: glowPulseBronze 3s infinite alternate ease-in-out;
}

/* --- RESPONSIVE MOBILE (Mejorado) --- */
@media (max-width: 600px) {
ย ย .podium {
ย ย ย ย flex-direction: column;
ย ย ย ย align-items: center;
ย ย ย ย gap: 1.5rem;
ย ย }
ย ยย
ย ย .podium-card {
ย ย ย ย width: 100%;
ย ย ย ย min-height: auto; /* Dejamos la altura flexible en mรณvil */
ย ย ย ย order: unset !important; /* Desactiva el orden para que salgan 1, 2, 3 en vertical */
ย ย ย ย margin-bottom: 0;
ย ย ย ย display: flex;
ย ย ย ย flex-direction: row; /* Hacemos las tarjetas horizontales en mรณvil */
ย ย ย ย align-items: center;
ย ย ย ย text-align: left;
ย ย ย ย padding: 1rem;
ย ย }

ย ย /* Ajuste para que el texto ocupe el espacio */
ย ย .podium-content { flex: 1; }ย

ย ย /* Asegurar que los avatares grandes se vean bien en modo horizontal */
ย ย .podium-card .avatar { margin: 0 1rem 0 0; width: 70px; height: 70px; }

ย ย /* Estilos especรญficos para la tarjeta 1 en mรณvil */
ย ย .rank-1 { transform: scale(1.0); } /* Eliminamos el escalado extra en mรณvil */
}

ย ย ย ย /* Coronas e Iconos, Avatares, Puntos... (Sin cambios) */
ย ย ย ย .crown { font-size: 1.5rem; margin-bottom: 0.5rem; display: block; }
ย ย ย ย .rank-1 .crown { color: var(--gold); text-shadow: 0 0 10px var(--gold); font-size: 2rem; }
ย ย ย ย .rank-2 .crown { color: var(--silver); text-shadow: 0 0 10px var(--silver); }
ย ย ย ย .rank-3 .crown { color: var(--bronze); text-shadow: 0 0 10px var(--bronze); }

ย ย ย ย .avatar {
ย ย ย ย ย ย width: 80px; height: 80px; border-radius: 50%; object-fit: cover;
ย ย ย ย ย ย border: 3px solid rgba(255,255,255,0.2); margin: 0 auto 10px; background: #334155;
ย ย ย ย }
ย ย ย ย .rank-1 .avatar { width: 100px; height: 100px; border-color: var(--gold); }
ย ย ย ย .rank-2 .avatar { border-color: var(--silver); }
ย ย ย ย .rank-3 .avatar { border-color: var(--bronze); }

ย ย ย ย .p-name { font-weight: 800; font-size: 1.1rem; margin-bottom: 4px; }
ย ย ย ย .p-team { font-size: 0.8rem; color: #94a3b8; text-transform: uppercase; letter-spacing: 1px; margin-bottom: 1rem; }
ย ย ย ย .p-points { font-family: 'Russo One', sans-serif; font-size: 1.8rem; background: rgba(0,0,0,0.3); padding: 5px 10px; border-radius: 8px; display: inline-block; }

ย ย ย ย /* --- LISTA DEL RESTO (4ยบ en adelante) --- */
ย ย ย ย .list { display: flex; flex-direction: column; gap: 1rem; }

ย ย ย ย .list-item {
ย ย ย ย ย ย display: flex;
ย ย ย ย ย ย align-items: center;
ย ย ย ย ย ย background: rgba(15, 23, 42, 0.8);
ย ย ย ย ย ย border: 1px solid rgba(255,255,255,0.05);
ย ย ย ย ย ย padding: 1rem;
ย ย ย ย ย ย border-radius: 12px;
ย ย ย ย ย ย transition: all 0.2s;
ย ย ย ย }

ย ย ย ย .rank-num { font-family: 'Russo One'; font-size: 1.5rem; color: #64748b; width: 40px; text-align: center; }
ย ย ย ย .mini-avatar { width: 50px; height: 50px; border-radius: 50%; margin: 0 1rem; object-fit: cover; border: 2px solid #334155; }
ย ย ย ย .info { flex-grow: 1; }
ย ย ย ย .l-name { font-weight: 700; font-size: 1.1rem; }
ย ย ย ย .l-team { font-size: 0.85rem; color: #94a3b8; }
ย ย ย ยย
ย ย ย ย .l-points { font-family: 'Russo One'; font-size: 1.4rem; color: var(--accent); }
ย ย ย ย .l-points span { font-size: 0.8rem; color: #64748b; font-family: 'Montserrat'; }

ย ย ย ย /* --- RESPONSIVE MOBILE (Sin cambios) --- */
ย ย ย ย @media (max-width: 600px) {
ย ย ย ย ย ย .podium-card-link:hover .podium-card, .list-item-link:hover .list-item {
ย ย ย ย ย ย ย ย transform: scale(1.01);
ย ย ย ย ย ย ย ย box-shadow: 0 5px 15px rgba(59, 130, 246, 0.4);ย
ย ย ย ย ย ย }

ย ย ย ย ย ย .podium {
ย ย ย ย ย ย ย ย flex-direction: column;
ย ย ย ย ย ย ย ย align-items: center;
ย ย ย ย ย ย ย ย gap: 1.5rem;
ย ย ย ย ย ย }
ย ย ย ย ย ยย
ย ย ย ย ย ย .podium-card {
ย ย ย ย ย ย ย ย width: 100%;
ย ย ย ย ย ย ย ย height: auto !important;ย
ย ย ย ย ย ย ย ย order: unset !important;ย
ย ย ย ย ย ย ย ย margin-bottom: 0;
ย ย ย ย ย ย ย ย display: flex;
ย ย ย ย ย ย ย ย align-items: center;
ย ย ย ย ย ย ย ย text-align: left;
ย ย ย ย ย ย ย ย padding: 1rem;
ย ย ย ย ย ย }

ย ย ย ย ย ย .podium-card .avatar { margin: 0 1rem 0 0; width: 70px; height: 70px; }
ย ย ย ย ย ย .podium-content { flex: 1; }
ย ย ย ย ย ยย
ย ย ย ย ย ย .rank-1 { transform: scale(1.02); }
ย ย ย ย }
ย ย </style>
</head>
<body>
ย ย <nav class="navbar">
ย ย ย ย <a href="./" class="nav-link">๐ Clasificaciรณn</a>
ย ย ย ย <a href="./inscripcion/" class="nav-link">๐ Preinscripciรณn</a>
ย ย ย ย <a href="./sorteo/" class="nav-link">๐๏ธ Sorteo</a>
ย ย </nav>
ย ย <div class="container">
ย ย ย ย <h1><i class="fa-solid fa-trophy"></i> Clasificaciรณn</h1>

ย ย ย ย <div id="podium-container" class="podium"></div>

ย ย ย ย <div id="list-container" class="list"></div>

ย ย </div>

ย ย <script>
ย ย // ==========================================
ย ย // โ๏ธ CONFIGURACIรN
ย ย // ==========================================

ย ย // PEGA AQUร EL ENLACE "PUBLICAR EN LA WEB" (FORMATO CSV) DE TU GOOGLE SHEET
ย ย const GOOGLE_CSV_LINK = "https://docs.google.com/spreadsheets/d/e/2PACX-1vTlPsGq-SypD4WPitvnR7JcluA8_6-5ePtuzyf5zFGJ31eppN55iUIHsKo0oduOZ9AVyVTf6VkPvTyu/pub?output=csv";

ย ย // 2. USAMOS ESTE ENLACE (Con el proxy para que funcione en local)
ย ย // Se han usado comillas invertidas (\`) para evitar cualquier problema de caracteres.
ย ย const SHEET_URL = `https://api.allorigins.win/raw?url=${encodeURIComponent(GOOGLE_CSV_LINK)}`;
ย ย // ==========================================
ย ย // ๐ LรGICA DE CARGA DE DATOS
ย ย // ==========================================

ย ย async function fetchLeaderboardData() {
ย ย ย ย const podiumContainer = document.getElementById('podium-container');
ย ย ย ย const listContainer = document.getElementById('list-container');
ย ย ย ยย
ย ย ย ย listContainer.innerHTML = '<div style="text-align:center; color:#94a3b8;"><i class="fa-solid fa-spinner fa-spin"></i> Cargando datos del campeonato...</div>';

ย ย ย ย try {
ย ย ย ย ย ย const response = await fetch(SHEET_URL);
ย ย ย ย ย ย const data = await response.text();
ย ย ย ย ย ยย
ย ย ย ย ย ย const drivers = parseCSV(data);
ย ย ย ย ย ยย
ย ย ย ย ย ย renderLeaderboard(drivers);
ย ย ย ย ย ยย
ย ย ย ย } catch (error) {
ย ย ย ย ย ย console.error("Error al cargar el Google Sheet:", error);
ย ย ย ย ย ย listContainer.innerHTML = '<div style="text-align:center; color:#ef4444;">Error al cargar los datos. Verifica el enlace CSV.</div>';
ย ย ย ย }
ย ย }

ย ย // Funciรณn auxiliar para leer el CSV crudo
ย ย function parseCSV(csvText) {
ย ย ย ย const lines = csvText.split('\n');
ย ย ย ย const drivers = [];
ย ย ย ยย
ย ย ย ย for (let i = 1; i < lines.length; i++) {
ย ย ย ย ย ย const line = lines[i].trim();
ย ย ย ย ย ย if (!line) continue;
ย ย ย ย ย ยย
ย ย ย ย ย ย const parts = line.split(',');
ย ย ย ย ย ยย
ย ย ย ย ย ย if (parts.length >= 3) {
ย ย ย ย ย ย ย ย drivers.push({
ย ย ย ย ย ย ย ย ย ย name: parts[0].trim(),
ย ย ย ย ย ย ย ย ย ย team: parts[1].trim(),
ย ย ย ย ย ย ย ย ย ย points: parseInt(parts[2].trim()) || 0,
ย ย ย ย ย ย ย ย ย ย photo: parts[3] ? parts[3].trim() : "https://www.w3schools.com/howto/img_avatar.png"ย
ย ย ย ย ย ย ย ย });
ย ย ย ย ย ย }
ย ย ย ย }
ย ย ย ย return drivers;
ย ย }

ย ย // ==========================================
ย ย // ๐จ RENDERIZADO (CON ENLACES AL PERFIL)
ย ย // ==========================================

ย ย function renderLeaderboard(driversData) {
ย ย ย ย const podiumContainer = document.getElementById('podium-container');
ย ย ย ย const listContainer = document.getElementById('list-container');

ย ย ย ย // Limpiar contenedores
ย ย ย ย podiumContainer.innerHTML = '';
ย ย ย ย listContainer.innerHTML = '';

ย ย ย ย // 1. Ordenar pilotos por puntos (Mayor a menor)
ย ย ย ย const sortedDrivers = driversData.sort((a, b) => b.points - a.points);

ย ย ย ย // 2. Separar Top 3 del resto
ย ย ย ย const top3 = sortedDrivers.slice(0, 3);
ย ย ย ย const rest = sortedDrivers.slice(3);

ย ย ย ย // 3. Renderizar Podio (Top 3)
ย ย ย ย let podiumHTML = '';
ย ย ย ยย
ย ย ย ย top3.forEach((driver, index) => {
ย ย ย ย ย ย const rank = index + 1;
ย ย ย ย ย ย let crownIcon = '';
ย ย ย ย ย ย if(rank === 1) crownIcon = '<i class="fa-solid fa-crown crown"></i>';
ย ย ย ย ย ย if(rank === 2) crownIcon = '<i class="fa-solid fa-medal crown"></i>';
ย ย ย ย ย ย if(rank === 3) crownIcon = '<i class="fa-solid fa-award crown"></i>';

ย ย ย ย ย ย const driverNameUrl = encodeURIComponent(driver.name);
ย ย ย ย ย ย // Usando Template Literals para la inyecciรณn de HTML con ${}
ย ย ย ย ย ย podiumHTML += `
ย ย ย ย ย ย ย ย <div class="podium-card rank-${rank}">
ย ย ย ย ย ย ย ย ย ย ${crownIcon}
ย ย ย ย ย ย ย ย ย ย <a href="perfil.html?driver=${driverNameUrl}" class="podium-card-link">
ย ย ย ย ย ย ย ย ย ย ย ย <img src="${driver.photo}" alt="${driver.name}" class="avatar">
ย ย ย ย ย ย ย ย ย ย ย ย <div class="podium-content">
ย ย ย ย ย ย ย ย ย ย ย ย ย ย <div class="p-name">${driver.name}</div>
ย ย ย ย ย ย ย ย ย ย ย ย ย ย <div class="p-team">${driver.team}</div>
ย ย ย ย ย ย ย ย ย ย ย ย ย ย <div class="p-points">${driver.points}</div>
ย ย ย ย ย ย ย ย ย ย ย ย </div>
ย ย ย ย ย ย ย ย ย ย </a>
ย ย ย ย ย ย ย ย </div>
ย ย ย ย ย ย `;
ย ย ย ย });
ย ย ย ย podiumContainer.innerHTML = podiumHTML;

ย ย ย ย // 4. Renderizar Lista (Resto)
ย ย ย ย let listHTML = '';
ย ย ย ยย
ย ย ย ย rest.forEach((driver, index) => {
ย ย ย ย ย ย const rank = index + 4;
ย ย ย ย ย ยย
ย ย ย ย ย ย const driverNameUrl = encodeURIComponent(driver.name);
ย ย ย ย ย ย listHTML += `
ย ย ย ย ย ย ย ย <a href="perfil.html?driver=${driverNameUrl}" class="list-item-link">
ย ย ย ย ย ย ย ย <div class="list-item">
ย ย ย ย ย ย ย ย ย ย <div class="rank-num">${rank}</div>
ย ย ย ย ย ย ย ย ย ย <img src="${driver.photo}" alt="${driver.name}" class="mini-avatar">
ย ย ย ย ย ย ย ย ย ย <div class="info">
ย ย ย ย ย ย ย ย ย ย ย ย <div class="l-name">${driver.name}</div>
ย ย ย ย ย ย ย ย ย ย ย ย <div class="l-team">${driver.team}</div>
ย ย ย ย ย ย ย ย ย ย </div>
ย ย ย ย ย ย ย ย ย ย <div class="l-points">${driver.points} <span>PTS</span></div>
ย ย ย ย ย ย ย ย </div>
ย ย ย ย ย ย ย ย </a>
ย ย ย ย ย ย `;
ย ย ย ย });
ย ย ย ย listContainer.innerHTML = listHTML;
ย ย }

ย ย // Iniciar carga al abrir la web
ย ย document.addEventListener('DOMContentLoaded', fetchLeaderboardData);

    // ==========================================
    // ๐ REGISTRO DEL SERVICE WORKER (PWA)
    // ==========================================
    if ('serviceWorker' in navigator) {
      window.addEventListener('load', () => {
        navigator.serviceWorker.register('./sw.js')
          .then(registration => {
            console.log('SW registrado con รฉxito:', registration);
          })
          .catch(error => {
            console.log('Fallo en el registro del SW:', error);
          });
      });
    }
    // ==========================================
ย ย </script>

</body>
</html>
