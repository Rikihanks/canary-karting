<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Registro de Equipo | GP</title>
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;600;800&family=Russo+One&display=swap"
        rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <link rel="stylesheet" href="./styles.css">
</head>

<body>

    <nav class="navbar">
        <a href="../" class="nav-link">üèÜ <br>Clasificaci√≥n</a>
        <a href="../inscripcion/" class="nav-link">üìù <br>Preinscripci√≥n</a>
        <a href="../sorteo/" class="nav-link">üèéÔ∏è <br>Sorteo</a>
    </nav>

    <div class="main-wrapper">
        <div class="container">
            <h1><i class="fa-solid fa-flag-checkered"></i>Preinscripci√≥n Canary Karting</h1>

            <div class="form-group">
                <label for="nombre" class="centered-text">¬øQuieres correr con nosotros?
                    <p></p> Lee detenidamente nuestro documento de reglas y rellena el siguiente formulario.
                </label>
            </div>

            <div class="form-group">
                <a href="https://drive.google.com/file/d/18RiuNlUViofUXUaP6URrBIJwfPEFuGr3/view?usp=sharing"
                    target="_blank" class="neon-link">
                    <i class="fa-solid fa-file-pdf"></i> Normativa Preinscripci√≥n
                </a>
            </div>

            <form id="registration-form">
                <div class="form-group">
                    <label for="nombre">Nombre Completo</label>
                    <input type="text" id="nombre" name="nombre" required>
                </div>

                <div class="form-group">
                    <label for="email">Correo Electr√≥nico</label>
                    <input type="email" id="email" name="email" required>
                </div>

                <div class="form-group">
                    <label for="telefono">Tel√©fono</label>
                    <input type="tel" id="telefono" name="telefono">
                </div>

                <div class="form-group">
                    <label for="experiencia">¬øTienes experiencia previa en karting? ¬øEn qu√© circuitos de la isla has
                        corrido?</label>
                    <input type="text" id="experiencia" name="experiencia">
                </div>

                <div class="form-group">
                    <label for="tiempos">¬øCuales son tus mejores tiempos por circuito? </label>
                    <small>Dejar en blanco si no los sabes</small>
                    <input type="text" id="tiempos" name="tiempos">
                </div>

                <div class="form-group">
                    <label for="peso">¬øPeso aproximado? </label>
                    <input type="text" id="peso" name="peso">
                </div>

                <button type="submit" id="submit-button">Enviar Solicitud</button>

                <div id="form-message"></div>
            </form>
        </div>
    </div>
    <script>
        // === CONFIGURACI√ìN ===
        // ‚¨ÖÔ∏è PEGA AQU√ç LA URL DE DESPLIEGUE DE TU GOOGLE APPS SCRIPT
        const WEB_APP_URL = "https://script.google.com/macros/s/AKfycbylVampyPezpAMNt4ux_MApY92l8hXZyJmZ1Zr54EkxCn8G_x6cE_boUNOJumDA_Lrx/exec";

        const form = document.getElementById('registration-form');
        const submitButton = document.getElementById('submit-button');
        const messageDiv = document.getElementById('form-message');

        form.addEventListener('submit', async function (e) {
            e.preventDefault(); // Detiene el env√≠o normal del formulario

            submitButton.disabled = true;
            submitButton.textContent = 'Enviando...';
            messageDiv.textContent = '';
            messageDiv.classList.remove('success', 'error');

            // Crea un objeto FormData a partir del formulario
            const formData = new FormData(form);

            // Crear el cuerpo de la petici√≥n (debe ser un objeto URLSearchParams para Apps Script)
            const params = new URLSearchParams(formData);

            // A√±adir el par√°metro de acci√≥n para que el Apps Script sepa qu√© hacer
            params.append('action', 'submitForm');

            try {
                const response = await fetch(WEB_APP_URL, {
                    method: 'POST',
                    body: params, // Se env√≠a como x-www-form-urlencoded
                });

                // Apps Script devuelve un objeto JSON con {success: true}
                const result = await response.json();

                if (result.success) {
                    messageDiv.textContent = '¬°Inscripci√≥n enviada con √©xito! Revisa tu correo.';
                    messageDiv.classList.add('success');
                    form.reset(); // Limpia el formulario
                } else {
                    throw new Error('El script de Google no devolvi√≥ √©xito.');
                }

            } catch (error) {
                console.error('Error de env√≠o:', error);
                messageDiv.textContent = 'Error al enviar la solicitud. Int√©ntalo de nuevo.';
                messageDiv.classList.add('error');
            } finally {
                submitButton.disabled = false;
                submitButton.textContent = 'Enviar Solicitud';
            }
        });
    </script>

</body>

</html>